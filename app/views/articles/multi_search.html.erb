<% content_for :js do %>
  <%= javascript_import_module_tag "shared/hamburger" %>
  <%= javascript_import_module_tag "shared/search" %>
  <%= javascript_import_module_tag "shared/multi_search" %>
  <%= javascript_import_module_tag "fontawesome" %>
<% end %>

<% assign_meta_tags title: "#{seo_title @category_name, params["type"]}" %>

<main>
  <div class="sp_search_bar">
    <a class="bar_inner" id="bar_inner">
      <div class="left_content">
        <i class="fa fa-search "></i> 
      </div>
      <div class="middle_content">
        <% if @prefecture_name.present? %>
          <p><%= @prefecture_name %></p>
        <% end %>

        <% if @city_name.present? %>
          <hr>
          <p><%= @city_name %></p>
        <% end %>

        <% if @category_name.present? %>
          <hr>
          <p><%= @category_name %></p>
        <% end %>
      </div>
      <div class="right_content">
        <p>変更</p>
      </div>
    </a>
  </div>
  <div class="front_main_container">
    <p class="pankuzu">
      <%= link_to 'ホーム', root_path, class: 'common_a' %>
      >
      <%= multi_searched_links @prefecture_name, @city_name, @category_name %>
    </p>

    <div id="search-overlay">
      <%= form_with url: multi_search_articles_path, method: :get, local: true, id: "search-form", class: "search-form sp_search_form" do %>
        <div class="form-group">
          <label for="prefecture">都道府県<span>から探す</span></label>
          <%= select_tag :prefecture, options_for_select(Area.unique_prefectures, params[:prefecture]), include_blank: "選択してください", id: "prefecture", class: "form-control" %>
        </div>

        <div class="form-group">
          <label for="city">市区町村<span>から探す</span></label>
          <%= select_tag :city, options_for_select([], params[:city]), include_blank: "都道府県を選択してください", id: "city", class: "form-control" %>
        </div>

        <div class="form-group">
          <label for="category">ジャンル<span>から探す</span></label>
          <%= select_tag :category, options_for_select(Category.order_categoies, params[:category]), include_blank: "選択してください", id: "category", class: "form-control" %>
        </div>
        <%= submit_tag 'この条件で検索する', class: 'search-button btn btn-primary' %>
      <% end %>
    </div>
    <div class="main_content">
      <section class="content_left">
        <div class="news">
          <div class="common_title">
            <h2>
              <%= @title_en %> <span><%= @title_ja %></span>
            </h2>
          </div>
          <% if @multi_search_articles.present? %>
            <div class="common_content">
              <% @multi_search_articles.each do |article| %>
                <%= link_to article_path(article), class: 'common_content_part' do %>
                  <div class="image_part">
                    <%= image_tag article.top_image if article.top_image.attached? %>
                  </div>
                  <p><%= truncate_content(article.title, 31) %></p>
                  <p><%= article.created_at.strftime("%Y/%m/%d") %></p>
                <% end %>
              <% end %>
            </div>
          <% else %>
            <p class="not_content">記事がひとつもありません。</p>
          <% end %>

          <% if @multi_search_articles.present? %>
            <%= paginate @multi_search_articles, theme: 'multi_search_article_custom_paginator' %>
          <% end %>
        </div>
      </section>
      <aside class="content_right">
        <%= render partial: "shared/sidebar", locals: {
          ranking_areas: @ranking_areas
        } %>
      </aside>
    </div>
  </div>
</main>
